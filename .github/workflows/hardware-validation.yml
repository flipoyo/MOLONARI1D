name: Hardware Validation

on:
  push:
    paths:
      - 'hardware/**'
      - '.github/workflows/hardware-validation.yml'
  pull_request:
    paths:
      - 'hardware/**'
      - '.github/workflows/hardware-validation.yml'

jobs:
  structure-validation:
    runs-on: ubuntu-latest
    
    steps:
      - name: Checkout repository
        uses: actions/checkout@v4
        
      - name: Validate hardware structure
        run: |
          echo "Checking hardware directory structure..."
          
          # Check if main directories exist
          for dir in sensors relay shared tests docs deployment; do
            if [ -d "hardware/$dir" ]; then
              echo "✓ hardware/$dir exists"
            else
              echo "✗ hardware/$dir missing"
              exit 1
            fi
          done
          
      - name: Check Arduino files
        run: |
          echo "Checking Arduino file structure..."
          
          # Check if main Arduino files exist
          if [ -f "hardware/field_code/mains_ino/sensor/Sensor.ino" ]; then
            echo "✓ sensor Arduino file exists"
          else
            echo "✗ sensor Arduino file missing"
            exit 1
          fi
          
          if [ -f "hardware/field_code/mains_ino/relay/Relay.ino" ]; then
            echo "✓ Relay Arduino file exists"
          else
            echo "✗ Relay Arduino file missing"
            exit 1
          fi
          
      - name: Check documentation
        run: |
          echo "Checking hardware documentation..."
          
          # Check if key documentation files exist
          for doc in "1 - Installation guide_ENG.md" "2 - Explaning the sensor code.md" "4 - Our LoRa protocol_ENG.md" "5 - Gateway and server configurations.md"; do
            if [ -f "hardware/docs/$doc" ]; then
              echo "✓ $doc exists"
            else
              echo "✗ $doc missing"
              exit 1
            fi
          done
